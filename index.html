<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forecast Data Viewer</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        body {
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-bottom: none;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
        }
        .tab.active {
            background: white;
            border-bottom: 1px solid white;
            margin-bottom: -1px;
            font-weight: bold;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            align-items: center;
        }
        .date-range {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        input[type="date"] {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            padding: 8px 15px;
            background: #4a6ee0;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #3a5ecf;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px 12px;
            text-align: center;
            white-space: nowrap;
        }
        th {
            background-color: #f2f2f2;
            position: sticky;
            top: 0;
        }
        .planning-group-header {
            background-color: #e6f2ff;
            font-weight: bold;
        }
        .media-type-header {
            background-color: #f0f8ff;
        }
        .data-row:nth-child(even) {
            background-color: #f9f9f9;
        }
        .chart-container {
            margin-top: 30px;
            height: 400px;
        }
        .notification {
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 4px;
            display: none;
        }
        .notification.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .notification.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Forecast Data Viewer</h1>
            <div class="date-range">
                <label for="startDate">Start Date:</label>
                <input type="date" id="startDate">
                <label for="endDate">End Date:</label>
                <input type="date" id="endDate">
                <button id="refreshBtn">Refresh Data</button>
            </div>
        </div>
        
        <div id="notification" class="notification"></div>
        
        <div class="tabs">
            <div class="tab active" data-tab="weekly">Weekly View</div>
            <div class="tab" data-tab="monthly">Monthly View</div>
        </div>
        
        <div class="tab-content active" id="weekly-tab">
            <div class="controls">
                <button id="prevWeek">Previous Week</button>
                <span id="weekRange"></span>
                <button id="nextWeek">Next Week</button>
            </div>
            <div id="weekly-table-container"></div>
        </div>
        
        <div class="tab-content" id="monthly-tab">
            <div class="controls">
                <button id="prevMonth">Previous Month</button>
                <span id="monthRange"></span>
                <button id="nextMonth">Next Month</button>
            </div>
            <div id="monthly-table-container"></div>
        </div>
        
        <div class="chart-container">
            <canvas id="forecastChart"></canvas>
        </div>
    </div>

    <script>
        // Sample data - in a real app, this would come from an API
        const sampleData = {
          "status": "Complete",
          "operationId": "b4e8cf4e-126a-4c48-ac6c-d7340c3f488c",
          "result": {
            "startDate": "2022-10-16T23:00:00Z",
            "endDate": "2022-10-17T23:00:00Z",
            "intervalLengthMinutes": 15,
            "categories": [
              "ForecastData",
              "ScheduleData",
              "PerformancePredictionData"
            ],
            "shortTermForecast": {
              "id": "79db148b-31f6-4a5a-a3ac-937bf9815bab",
              "weekDate": "2022-09-26"
            },
            "schedule": {
              "id": "de2c2025-f84f-444b-9d62-cb56f4f15432",
              "weekDate": "2022-09-26"
            },
            "intradayDataGroupings": [
              {
                "mediaType": "Voice",
                "forecastDataSummary": {
                  "offered": 392.4154534199729,
                  "averageHandleTimeSeconds": 264.9722608445349
                },
                "forecastDataPerInterval": [
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  {
                    "offered": 2.9982618771726535,
                    "averageHandleTimeSeconds": 187.02072466
                  },
                  {
                    "offered": 5.998769987699877,
                    "averageHandleTimeSeconds": 279.4864377908602
                  },
                  {
                    "offered": 16.122648165569146,
                    "averageHandleTimeSeconds": 284.544742196871
                  },
                  {
                    "offered": 14.871963562753036,
                    "averageHandleTimeSeconds": 251.5306292188417
                  },
                  {
                    "offered": 10.5,
                    "averageHandleTimeSeconds": 286.93972279009523
                  },
                  {
                    "offered": 14.25,
                    "averageHandleTimeSeconds": 277.9745028905263
                  },
                  {
                    "offered": 10.5,
                    "averageHandleTimeSeconds": 268.675256232
                  },
                  {
                    "offered": 9.122753818508535,
                    "averageHandleTimeSeconds": 259.99246316054365
                  },
                  {
                    "offered": 13.5,
                    "averageHandleTimeSeconds": 241.1569063037037
                  },
                  {
                    "offered": 7.043695258434256,
                    "averageHandleTimeSeconds": 309.3494772898252
                  },
                  {
                    "offered": 8.625,
                    "averageHandleTimeSeconds": 275.7446309911304
                  },
                  {
                    "offered": 9.498203054806828,
                    "averageHandleTimeSeconds": 258.4108354699617
                  },
                  {
                    "offered": 18.372420464316424,
                    "averageHandleTimeSeconds": 262.1672524376065
                  },
                  {
                    "offered": 8.75,
                    "averageHandleTimeSeconds": 263.4668589977143
                  },
                  {
                    "offered": 4.125,
                    "averageHandleTimeSeconds": 279.52409970727274
                  },
                  {
                    "offered": 12,
                    "averageHandleTimeSeconds": 261.57824753958334
                  },
                  {
                    "offered": 11.5,
                    "averageHandleTimeSeconds": 278.2886767327826
                  },
                  {
                    "offered": 7,
                    "averageHandleTimeSeconds": 293.8899206588572
                  },
                  {
                    "offered": 11.75,
                    "averageHandleTimeSeconds": 260.53499728340427
                  },
                  {
                    "offered": 13.997093023255815,
                    "averageHandleTimeSeconds": 279.9877865978972
                  },
                  {
                    "offered": 7.107142857142857,
                    "averageHandleTimeSeconds": 316.7075526243015
                  },
                  {
                    "offered": 11.799478192338958,
                    "averageHandleTimeSeconds": 311.0273200627471
                  },
                  {
                    "offered": 9.122895622895623,
                    "averageHandleTimeSeconds": 240.93874563059373
                  },
                  {
                    "offered": 3,
                    "averageHandleTimeSeconds": 267.3111861144186
                  },
                  {
                    "offered": 9.125,
                    "averageHandleTimeSeconds": 296.57759108230135
                  },
                  {
                    "offered": 13.5,
                    "averageHandleTimeSeconds": 249.05661373422225
                  },
                  {
                    "offered": 12.747194950911641,
                    "averageHandleTimeSeconds": 281.453798113811
                  },
                  {
                    "offered": 12.75,
                    "averageHandleTimeSeconds": 271.48190207670586
                  },
                  {
                    "offered": 12.872261774370207,
                    "averageHandleTimeSeconds": 272.1826930971825
                  },
                  {
                    "offered": 8.872682502896872,
                    "averageHandleTimeSeconds": 258.5971477241099
                  },
                  {
                    "offered": 8.625,
                    "averageHandleTimeSeconds": 255.2615118750145
                  },
                  {
                    "offered": 13.123374512353706,
                    "averageHandleTimeSeconds": 274.4901487836595
                  },
                  {
                    "offered": 8.625,
                    "averageHandleTimeSeconds": 265.00208889089856
                  },
                  {
                    "offered": 9.872553017944536,
                    "averageHandleTimeSeconds": 267.32557463893005
                  },
                  {
                    "offered": 9.75,
                    "averageHandleTimeSeconds": 284.9702033282051
                  },
                  {
                    "offered": 1,
                    "averageHandleTimeSeconds": 191.361739107
                  },
                  {
                    "offered": 4,
                    "averageHandleTimeSeconds": 193.002638906
                  },
                  {
                    "offered": 5,
                    "averageHandleTimeSeconds": 190.54538464499998
                  },
                  {
                    "offered": 6,
                    "averageHandleTimeSeconds": 194.972884645
                  },
                  {
                    "offered": 2,
                    "averageHandleTimeSeconds": 209.98108107899998
                  },
                  {
                    "offered": 2.9989568845618915,
                    "averageHandleTimeSeconds": 196.423652194
                  },
                  {
                    "offered": 1.9985974754558204,
                    "averageHandleTimeSeconds": 197.89
                  },
                  {
                    "offered": 5,
                    "averageHandleTimeSeconds": 194.05974357
                  },
                  {
                    "offered": 0.9995064165844026,
                    "averageHandleTimeSeconds": 201.20765434
                  },
                  {
                    "offered": 2,
                    "averageHandleTimeSeconds": 160.93
                  },
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null
                ],
                "scheduleDataSummary": {
                  "onQueueTimeSeconds": 25200
                },
                "scheduleDataPerInterval": [
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  null,
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  null,
                  null,
                  {
                    "onQueueTimeSeconds": 900
                  },
                  null,
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  {
                    "onQueueTimeSeconds": 900
                  },
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null
                ],
                "performancePredictionDataSummary": {
                  "serviceLevelPercent": 12.910564465443242,
                  "averageSpeedOfAnswerSeconds": 376.83212851114894,
                  "occupancyPercent": 52.31095273885799
                },
                "performancePredictionDataPerInterval": [
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  {
                    "serviceLevelPercent": 20.078764423140903,
                    "averageSpeedOfAnswerSeconds": 453.6145664137586,
                    "occupancyPercent": 100
                  },
                  {
                    "serviceLevelPercent": 19.417894929636315,
                    "averageSpeedOfAnswerSeconds": 157.00533935326996,
                    "occupancyPercent": 44.13530135432895
                  },
                  {
                    "serviceLevelPercent": 13.797774712578201,
                    "averageSpeedOfAnswerSeconds": 113.06195368318856,
                    "occupancyPercent": 65.45916107942668
                  },
                  {
                    "serviceLevelPercent": 0,
                    "averageSpeedOfAnswerSeconds": 285.6687680129021,
                    "occupancyPercent": 100
                  },
                  {
                    "serviceLevelPercent": 15.89093128550919,
                    "averageSpeedOfAnswerSeconds": 49.62571484811613,
                    "occupancyPercent": 25.162171212156863
                  },
                  {
                    "serviceLevelPercent": 14.046053182394145,
                    "averageSpeedOfAnswerSeconds": 228.44108425652834,
                    "occupancyPercent": 80.5552287509804
                  },
                  {
                    "serviceLevelPercent": 20.34328164676392,
                    "averageSpeedOfAnswerSeconds": 127.9867511762817,
                    "occupancyPercent": 38.493289767058826
                  },
                  {
                    "serviceLevelPercent": 23.532544784466328,
                    "averageSpeedOfAnswerSeconds": 128.39869046181738,
                    "occupancyPercent": 67.60826447753523
                  },
                  {
                    "serviceLevelPercent": 8.635301916013747,
                    "averageSpeedOfAnswerSeconds": 795.9307871490863,
                    "occupancyPercent": 100
                  },
                  {
                    "serviceLevelPercent": 12.248586070082235,
                    "averageSpeedOfAnswerSeconds": 13.92740867923899,
                    "occupancyPercent": 11.053882699212886
                  },
                  {
                    "serviceLevelPercent": 24.194386441561324,
                    "averageSpeedOfAnswerSeconds": 149.5600629069424,
                    "occupancyPercent": 40.05638297294117
                  },
                  {
                    "serviceLevelPercent": 10.112317734110578,
                    "averageSpeedOfAnswerSeconds": 618.7490568991617,
                    "occupancyPercent": 77.9147449339972
                  },
                  {
                    "serviceLevelPercent": 18.74042172976098,
                    "averageSpeedOfAnswerSeconds": 351.55996537865224,
                    "occupancyPercent": 52.4193396582217
                  },
                  {
                    "serviceLevelPercent": 9.752954912657303,
                    "averageSpeedOfAnswerSeconds": 170.3885819642818,
                    "occupancyPercent": 59.37399526666666
                  },
                  {
                    "serviceLevelPercent": 13.472740488099923,
                    "averageSpeedOfAnswerSeconds": 73.88983025314872,
                    "occupancyPercent": 31.813034183333333
                  },
                  {
                    "serviceLevelPercent": 18.364532666894238,
                    "averageSpeedOfAnswerSeconds": 117.17518249411924,
                    "occupancyPercent": 66.06872356045753
                  },
                  {
                    "serviceLevelPercent": 18.77037075451655,
                    "averageSpeedOfAnswerSeconds": 119.16972050868348,
                    "occupancyPercent": 37.77026144294119
                  },
                  {
                    "serviceLevelPercent": 13.26382491019945,
                    "averageSpeedOfAnswerSeconds": 17.443055610126798,
                    "occupancyPercent": 12.634822079215684
                  },
                  {
                    "serviceLevelPercent": 19.25164877157503,
                    "averageSpeedOfAnswerSeconds": 106.34067239082557,
                    "occupancyPercent": 64.43927014411764
                  },
                  {
                    "serviceLevelPercent": 16.419279009876174,
                    "averageSpeedOfAnswerSeconds": 443.4747137042516,
                    "occupancyPercent": 51.43135355465782
                  },
                  {
                    "serviceLevelPercent": 9.940848538725813,
                    "averageSpeedOfAnswerSeconds": 47.09893776840894,
                    "occupancyPercent": 19.054880951333335
                  },
                  {
                    "serviceLevelPercent": 3.284054553872143,
                    "averageSpeedOfAnswerSeconds": 21.272743714532595,
                    "occupancyPercent": 9.527448503001482
                  },
                  {
                    "serviceLevelPercent": 27.33256759123044,
                    "averageSpeedOfAnswerSeconds": 1120.4072738418781,
                    "occupancyPercent": 58.19830247707879
                  },
                  {
                    "serviceLevelPercent": 29.03112962970874,
                    "averageSpeedOfAnswerSeconds": 59.91028919620841,
                    "occupancyPercent": 23.796036402480617
                  },
                  {
                    "serviceLevelPercent": 17.870969203658003,
                    "averageSpeedOfAnswerSeconds": 62.2569228396158,
                    "occupancyPercent": 27.25140159320262
                  },
                  {
                    "serviceLevelPercent": 17.90995586714451,
                    "averageSpeedOfAnswerSeconds": 136.3497675521569,
                    "occupancyPercent": 71.75163398117647
                  },
                  {
                    "serviceLevelPercent": 2.302757955876276,
                    "averageSpeedOfAnswerSeconds": 2463.9204666281316,
                    "occupancyPercent": 100
                  },
                  {
                    "serviceLevelPercent": 13.136075372505758,
                    "averageSpeedOfAnswerSeconds": 47.70578655324417,
                    "occupancyPercent": 24.808150707712418
                  },
                  {
                    "serviceLevelPercent": 16.725155347903442,
                    "averageSpeedOfAnswerSeconds": 127.10930821379249,
                    "occupancyPercent": 67.43542798611108
                  },
                  {
                    "serviceLevelPercent": 26.09437713705943,
                    "averageSpeedOfAnswerSeconds": 418.207784897224,
                    "occupancyPercent": 51.0732435186763
                  },
                  {
                    "serviceLevelPercent": 26.30798098048165,
                    "averageSpeedOfAnswerSeconds": 496.5161555353634,
                    "occupancyPercent": 52.09119569751634
                  },
                  {
                    "serviceLevelPercent": 0,
                    "averageSpeedOfAnswerSeconds": 202.6587890863955,
                    "occupancyPercent": 100
                  },
                  {
                    "serviceLevelPercent": 10.378708722024214,
                    "averageSpeedOfAnswerSeconds": 140.80836303375278,
                    "occupancyPercent": 55.27264956888889
                  },
                  {
                    "serviceLevelPercent": 8.425021444052266,
                    "averageSpeedOfAnswerSeconds": 407.3817192346529,
                    "occupancyPercent": 89.70024470044861
                  },
                  {
                    "serviceLevelPercent": 0,
                    "averageSpeedOfAnswerSeconds": 0,
                    "occupancyPercent": 0
                  },
                  {
                    "serviceLevelPercent": 0,
                    "averageSpeedOfAnswerSeconds": 0,
                    "occupancyPercent": 0
                  },
                  {
                    "serviceLevelPercent": 0,
                    "averageSpeedOfAnswerSeconds": 0,
                    "occupancyPercent": 0
                  },
                  {
                    "serviceLevelPercent": 0,
                    "averageSpeedOfAnswerSeconds": 0,
                    "occupancyPercent": 0
                  },
                  {
                    "serviceLevelPercent": 0,
                    "averageSpeedOfAnswerSeconds": 0,
                    "occupancyPercent": 0
                  },
                  {
                    "serviceLevelPercent": 0,
                    "averageSpeedOfAnswerSeconds": 0,
                    "occupancyPercent": 0
                  },
                  {
                    "serviceLevelPercent": 0,
                    "averageSpeedOfAnswerSeconds": 0,
                    "occupancyPercent": 0
                  },
                  {
                    "serviceLevelPercent": 0,
                    "averageSpeedOfAnswerSeconds": 0,
                    "occupancyPercent": 0
                  },
                  {
                    "serviceLevelPercent": 0,
                    "averageSpeedOfAnswerSeconds": 0,
                    "occupancyPercent": 0
                  },
                  {
                    "serviceLevelPercent": 0,
                    "averageSpeedOfAnswerSeconds": 0,
                    "occupancyPercent": 0
                  },
                  {
                    "serviceLevelPercent": 0,
                    "averageSpeedOfAnswerSeconds": 0,
                    "occupancyPercent": 0
                  },
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                  null
                ]
              }
            ]
          }
        };

        // State management
        let currentView = 'weekly';
        let currentWeekStart = getMonday(new Date());
        let currentMonthStart = new Date(new Date().getFullYear(), new Date().getMonth(), 1);
        let forecastData = sampleData;

        // DOM elements
        const weeklyTab = document.getElementById('weekly-tab');
        const monthlyTab = document.getElementById('monthly-tab');
        const weeklyTableContainer = document.getElementById('weekly-table-container');
        const monthlyTableContainer = document.getElementById('monthly-table-container');
        const weekRange = document.getElementById('weekRange');
        const monthRange = document.getElementById('monthRange');
        const prevWeekBtn = document.getElementById('prevWeek');
        const nextWeekBtn = document.getElementById('nextWeek');
        const prevMonthBtn = document.getElementById('prevMonth');
        const nextMonthBtn = document.getElementById('nextMonth');
        const refreshBtn = document.getElementById('refreshBtn');
        const startDateInput = document.getElementById('startDate');
        const endDateInput = document.getElementById('endDate');
        const notification = document.getElementById('notification');
        const tabs = document.querySelectorAll('.tab');

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeDateInputs();
            updateWeeklyView();
            updateMonthlyView();
            setupEventListeners();
        });

        function initializeDateInputs() {
            const today = new Date();
            const oneWeekFromNow = new Date(today);
            oneWeekFromNow.setDate(today.getDate() + 7);
            
            startDateInput.value = formatDateForInput(today);
            endDateInput.value = formatDateForInput(oneWeekFromNow);
        }

        function setupEventListeners() {
            // Tab switching
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });

            // Navigation buttons
            prevWeekBtn.addEventListener('click', function() {
                currentWeekStart.setDate(currentWeekStart.getDate() - 7);
                updateWeeklyView();
            });

            nextWeekBtn.addEventListener('click', function() {
                currentWeekStart.setDate(currentWeekStart.getDate() + 7);
                updateWeeklyView();
            });

            prevMonthBtn.addEventListener('click', function() {
                currentMonthStart.setMonth(currentMonthStart.getMonth() - 1);
                updateMonthlyView();
            });

            nextMonthBtn.addEventListener('click', function() {
                currentMonthStart.setMonth(currentMonthStart.getMonth() + 1);
                updateMonthlyView();
            });

            // Refresh button
            refreshBtn.addEventListener('click', function() {
                refreshData();
            });
        }

        function switchTab(tabName) {
            currentView = tabName;
            
            // Update active tab
            tabs.forEach(tab => {
                if (tab.getAttribute('data-tab') === tabName) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
            
            // Show active content
            if (tabName === 'weekly') {
                weeklyTab.classList.add('active');
                monthlyTab.classList.remove('active');
            } else {
                weeklyTab.classList.remove('active');
                monthlyTab.classList.add('active');
            }
        }

        function updateWeeklyView() {
            const weekEnd = new Date(currentWeekStart);
            weekEnd.setDate(currentWeekStart.getDate() + 6);
            
            weekRange.textContent = `${formatDate(currentWeekStart)} - ${formatDate(weekEnd)}`;
            
            // Generate weekly table
            weeklyTableContainer.innerHTML = generateWeeklyTable();
        }

        function updateMonthlyView() {
            const monthEnd = new Date(currentMonthStart.getFullYear(), currentMonthStart.getMonth() + 1, 0);
            
            monthRange.textContent = `${currentMonthStart.toLocaleString('default', { month: 'long' })} ${currentMonthStart.getFullYear()}`;
            
            // Generate monthly table
            monthlyTableContainer.innerHTML = generateMonthlyTable();
        }

        function generateWeeklyTable() {
            const days = [];
            for (let i = 0; i < 7; i++) {
                const date = new Date(currentWeekStart);
                date.setDate(currentWeekStart.getDate() + i);
                days.push(date);
            }
            
            let html = '';
            
            // Generate table for each media type
            forecastData.result.intradayDataGroupings.forEach(group => {
                const mediaType = group.mediaType;
                const planningGroupName = mediaType === 'Voice' ? 'Customer Service - Voice' : 'Customer Service - Digital';
                const mediaTypeDisplay = mediaType === 'Voice' ? 'Voice' : 'Message';
                
                html += `
                <table>
                    <thead>
                        <tr class="planning-group-header">
                            <td colspan="${days.length + 1}">Planning Group Name: ${planningGroupName}</td>
                        </tr>
                        <tr class="media-type-header">
                            <td colspan="${days.length + 1}">Media Type: ${mediaTypeDisplay}</td>
                        </tr>
                        <tr>
                            <th></th>
                            ${days.map(day => `<th>${formatDate(day)}</th>`).join('')}
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="data-row">
                            <td>Offered</td>
                            ${days.map(() => `<td>${getRandomValue(80, 120)}</td>`).join('')}
                        </tr>
                        <tr class="data-row">
                            <td>Average Handle Time</td>
                            ${days.map(() => `<td>${getRandomValue(100, 150)}</td>`).join('')}
                        </tr>
                        <tr class="data-row">
                            <td>Service Level</td>
                            ${days.map(() => `<td>${getRandomValue(85, 95)}%</td>`).join('')}
                        </tr>
                        <tr class="data-row">
                            <td>Average Speed of Answer</td>
                            ${days.map(() => `<td>${getRandomValue(140, 160)}</td>`).join('')}
                        </tr>
                    </tbody>
                </table>
                `;
            });
            
            return html;
        }

        function generateMonthlyTable() {
            const daysInMonth = new Date(
                currentMonthStart.getFullYear(), 
                currentMonthStart.getMonth() + 1, 
                0
            ).getDate();
            
            const days = [];
            for (let i = 1; i <= daysInMonth; i++) {
                const date = new Date(currentMonthStart.getFullYear(), currentMonthStart.getMonth(), i);
                // Skip weekends if needed, or show all days
                days.push(date);
            }
            
            let html = '';
            
            // Generate table for each media type
            forecastData.result.intradayDataGroupings.forEach(group => {
                const mediaType = group.mediaType;
                const planningGroupName = mediaType === 'Voice' ? 'Customer Service - Voice' : 'Customer Service - Digital';
                const mediaTypeDisplay = mediaType === 'Voice' ? 'Voice' : 'Message';
                
                html += `
                <div style="overflow-x: auto;">
                    <table>
                        <thead>
                            <tr class="planning-group-header">
                                <td colspan="${days.length + 1}">Planning Group Name: ${planningGroupName}</td>
                            </tr>
                            <tr class="media-type-header">
                                <td colspan="${days.length + 1}">Media Type: ${mediaTypeDisplay}</td>
                            </tr>
                            <tr>
                                <th></th>
                                ${days.map(day => `<th>${formatDate(day)}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="data-row">
                                <td>Offered</td>
                                ${days.map(() => `<td>${getRandomValue(80, 120)}</td>`).join('')}
                            </tr>
                            <tr class="data-row">
                                <td>Average Handle Time</td>
                                ${days.map(() => `<td>${getRandomValue(100, 150)}</td>`).join('')}
                            </tr>
                            <tr class="data-row">
                                <td>Service Level</td>
                                ${days.map(() => `<td>${getRandomValue(85, 95)}%</td>`).join('')}
                            </tr>
                            <tr class="data-row">
                                <td>Average Speed of Answer</td>
                                ${days.map(() => `<td>${getRandomValue(140, 160)}</td>`).join('')}
                            </tr>
                        </tbody>
                    </table>
                </div>
                `;
            });
            
            return html;
        }

        function refreshData() {
            const startDate = startDateInput.value;
            const endDate = endDateInput.value;
            
            if (!startDate || !endDate) {
                showNotification('Please select both start and end dates', 'error');
                return;
            }
            
            // In a real application, this would be an API call
            showNotification('Data refreshed successfully', 'success');
            
            // Update views with new data
            updateWeeklyView();
            updateMonthlyView();
        }

        function showNotification(message, type) {
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // Utility functions
        function getMonday(date) {
            const d = new Date(date);
            const day = d.getDay();
            const diff = d.getDate() - day + (day === 0 ? -6 : 1); // adjust when day is Sunday
            return new Date(d.setDate(diff));
        }

        function formatDate(date) {
            return date.toLocaleDateString('en-GB');
        }

        function formatDateForInput(date) {
            return date.toISOString().split('T')[0];
        }

        function getRandomValue(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
    </script>
</body>
</html>
